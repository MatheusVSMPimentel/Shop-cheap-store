import{a as me,b as pt,c as lt,d as dt,e as ht,f as ei,g as ti,k as ri}from"./chunk-E4DCU2ZC.js";import{b as $t,c as Ee,e as mt,f as Zt,g as ii}from"./chunk-YGKAM2VZ.js";import{a as Kt,b as le,c as Jt}from"./chunk-4PUTRX2P.js";import{$ as m,$a as Wt,Aa as Vt,Ab as pe,Ba as d,Bb as nt,C as Rt,Ca as ne,Cb as at,D as Z,Da as k,Db as ot,E as Ce,Ea as Ht,Eb as st,Fa as Bt,Fb as ct,G as _e,Ga as Nt,Gb as Xt,Ha as F,Hb as Gt,I as D,Ia as ae,Ib as Be,J as Me,K as zt,Ka as oe,Na as Dt,O as je,Oa as Lt,P as w,Q as b,Qa as yt,Sa as Ge,T as he,Ta as we,U as Tt,Ua as be,V as Se,Vb as Ie,X as j,Xa as Ke,Y as U,Ya as Ut,_ as Ot,a as L,aa as M,b as At,da as kt,ea as Qe,f as G,fa as R,fb as jt,ga as vt,gb as Ae,ha as h,hb as se,ia as te,ib as Qt,ja as qe,jb as ce,kb as Je,la as p,lb as He,m as $,ma as c,mb as qt,n as Ve,na as g,nb as $e,oa as Ft,ob as Yt,p as xt,pa as Pt,pb as Ze,qa as re,ra as z,rb as P,sa as x,sb as et,t as de,tb as tt,va as Ye,w as It,wa as Xe,wb as it,xa as ue,y as Et,ya as ge,yb as rt,za as fe}from"./chunk-VXBRRWNJ.js";var Re=class{constructor(){this.imageChangedEvent="",this.croppedImage="",this.canvasRotation=0,this.rotation=0,this.scale=1,this.showCropper=!1,this.containWithinAspectRatio=!1,this.transform={},this.output="base64"}};var ze=class extends Kt{constructor(){super(),this.MASKS=mt,this.errors=[],this.validationMessages={supplierId:{required:"Choose a supplier."},name:{required:"Enter the product name.",minlength:"Minimum 2 characters.",maxlength:"Maximum 200 characters."},description:{required:"Description must be filled",minlength:"Minimum 2 characters",maxlength:"Maximum 1000 characters."},image:{required:"Insert an Image."},value:{required:"Insert an amount"}},super.settingUpMessagesValidation(this.validationMessages)}configurateValidationForm(n){super.settingUpFormValidation(n,[this.productForm])}};var q=(()=>{let n=class n extends Jt{constructor(e){super(),this.http=e,this.productUrl=this.urlServiceV1+"produtos/"}getAll(){return this.http.get(this.productUrl,this.getAuthJSONHeader()).pipe(de(super.serviceError))}getById(e){return this.http.get(this.productUrl+e,this.getAuthJSONHeader()).pipe(de(super.serviceError))}getSuppliers(){return this.http.get(this.urlServiceV1+"fornecedores",this.getAuthJSONHeader()).pipe(de(super.serviceError))}registerProduct(e){return this.http.post(this.productUrl,JSON.stringify(e),this.getAuthJSONHeader()).pipe($(this.extractData),de(this.serviceError))}updateProduct(e){return this.http.put(this.productUrl+e.id,JSON.stringify(e),this.getAuthJSONHeader()).pipe($(this.extractData),de(this.serviceError))}deleteProduct(e){return this.http.delete(this.productUrl+e,this.getAuthJSONHeader()).pipe($(this.extractData),de(this.serviceError))}};n.\u0275fac=function(t){return new(t||n)(_e(Wt))},n.\u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();var Mt="_",Ct="function",Mi=[];function _t(r=Mi,n=Mt){if(!oi(r))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(r.indexOf(n)!==-1)throw new Error(`Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.

The placeholder character that was received is: ${JSON.stringify(n)}

The mask that was received is: ${JSON.stringify(r)}`);return r.map(o=>o instanceof RegExp?n:o).join("")}function oi(r){return Array.isArray&&Array.isArray(r)||r instanceof Array}function si(r){return typeof r=="string"||r instanceof String}function Si(r){return typeof r=="number"&&(r===0||r&&!isNaN(r))}var wi="[]";function ci(r){let n=[],o;for(;o=r.indexOf(wi),o!==-1;)n.push(o),r.splice(o,1);return{maskWithoutCaretTraps:r,indexes:n}}var xe="";function bi(r=xe,n,o={}){if(!oi(n))if(typeof n===Ct)n=n(r,o),n=ci(n).maskWithoutCaretTraps;else throw new Error("Text-mask:conformToMask; The mask property must be an array.");let e=o.guide?o.guide:!0,t=o.previousConformedValue?o.previousConformedValue:xe,i=o.placeholderChar?o.placeholderChar:Mt,a=o.placeholder?o.placeholder:_t(n,i),s=o.currentCaretPosition?o.currentCaretPosition:0,l=o.keepCharPositions?o.keepCharPositions:!1,u=!e&&t!==void 0,y=r.length,v=t.length,_=a.length,T=n.length,A=y-v,H=A>0,B=s+(H?-A:0),N=B+Math.abs(A);if(l===!0&&!H){let f=xe;for(let S=B;S<N;S++)a[S]===i&&(f+=i);r=r.slice(0,B)+f+r.slice(B,y)}let C=r.split(xe).map((f,S)=>({char:f,isNew:S>=B&&S<N}));for(let f=y-1;f>=0;f--){let{char:S}=C[f];if(S!==i){let X=f>=B&&v===T;S===a[X?f-A:f]&&C.splice(f,1)}}let I=xe,O=!1;e:for(let f=0;f<_;f++){let S=a[f];if(S===i){if(C.length>0)for(;C.length>0;){let{char:X,isNew:V}=C.shift();if(X===i&&u!==!0){I+=i;continue e}else if(n[f].test(X)){if(l!==!0||V===!1||t===xe||e===!1||!H)I+=X;else{let K=C.length,ie=null;for(let W=0;W<K;W++){let ee=C[W];if(ee.char!==i&&ee.isNew===!1)break;if(ee.char===i){ie=W;break}}ie!==null?(I+=X,C.splice(ie,1)):f--}continue e}else O=!0}u===!1&&(I+=a.substr(f,_));break}else I+=S}if(u&&H===!1){let f=null;for(let S=0;S<I.length;S++)a[S]===i&&(f=S);f!==null?I=I.substr(0,f+1):I=xe}return{conformedValue:I,meta:{someCharsRejected:O}}}var ni=[],Te="";function Ai({previousConformedValue:r=Te,previousPlaceholder:n=Te,currentCaretPosition:o=0,conformedValue:e,rawValue:t,placeholderChar:i,placeholder:a,indexesOfPipedChars:s=ni,caretTrapIndexes:l=ni}){if(o===0||!t.length)return 0;let u=t.length,y=r.length,v=a.length,_=e.length,T=u-y,A=T>0,H=y===0;if(T>1&&!A&&!H)return o;let N=A&&(r===e||e===a),C=0,I,O;if(N)C=o-T;else{let f=e.toLowerCase(),V=t.toLowerCase().substr(0,o).split(Te).filter(E=>f.indexOf(E)!==-1);O=V[V.length-1];let K=n.substr(0,V.length).split(Te).filter(E=>E!==i).length,W=a.substr(0,V.length).split(Te).filter(E=>E!==i).length!==K,ee=n[V.length-1]!==void 0&&a[V.length-2]!==void 0&&n[V.length-1]!==i&&n[V.length-1]!==a[V.length-1]&&n[V.length-1]===a[V.length-2];!A&&(W||ee)&&K>0&&a.indexOf(O)>-1&&t[o]!==void 0&&(I=!0,O=t[o]);let We=s.map(E=>f[E]).filter(E=>E===O).length,ft=V.filter(E=>E===O).length,ye=a.substr(0,a.indexOf(i)).split(Te).filter((E,J)=>E===O&&t[J]!==E).length+ft+We+(I?1:0),Pe=0;for(let E=0;E<_;E++){let J=f[E];if(C=E+1,J===O&&Pe++,Pe>=ye)break}}if(A){let f=C;for(let S=C;S<=v;S++)if(a[S]===i&&(f=S),a[S]===i||l.indexOf(S)!==-1||S===v)return f}else if(I){for(let f=C-1;f>=0;f--)if(e[f]===O||l.indexOf(f)!==-1||f===0)return f}else for(let f=C;f>=0;f--)if(a[f-1]===i||l.indexOf(f)!==-1||f===0)return f}var pi="",ai="none",Ii="object",Ei=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),Ri=typeof requestAnimationFrame<"u"?requestAnimationFrame:setTimeout;function zi(r){let n={previousConformedValue:void 0,previousPlaceholder:void 0};return{state:n,update(o,{inputElement:e,mask:t,guide:i,pipe:a,placeholderChar:s=Mt,keepCharPositions:l=!1,showMask:u=!1}=r){if(typeof o>"u"&&(o=e.value),o===n.previousConformedValue)return;typeof t===Ii&&t.pipe!==void 0&&t.mask!==void 0&&(a=t.pipe,t=t.mask);let y,v;if(t instanceof Array&&(y=_t(t,s)),t===!1)return;let _=Oi(o),{selectionEnd:T}=e,{previousConformedValue:A,previousPlaceholder:H}=n,B;if(typeof t===Ct){if(v=t(_,{currentCaretPosition:T,previousConformedValue:A,placeholderChar:s}),v===!1)return;let{maskWithoutCaretTraps:ie,indexes:W}=ci(v);v=ie,B=W,y=_t(v,s)}else v=t;let N={previousConformedValue:A,guide:i,placeholderChar:s,pipe:a,placeholder:y,currentCaretPosition:T,keepCharPositions:l},{conformedValue:C}=bi(_,v,N),I=typeof a===Ct,O={};I&&(O=a(C,L({rawValue:_},N)),O===!1?O={value:A,rejected:!0}:si(O)&&(O={value:O}));let f=I?O.value:C,S=Ai({previousConformedValue:A,previousPlaceholder:H,conformedValue:f,placeholder:y,rawValue:_,currentCaretPosition:T,placeholderChar:s,indexesOfPipedChars:O.indexesOfPipedChars,caretTrapIndexes:B}),K=f===y&&S===0?u?y:pi:f;n.previousConformedValue=K,n.previousPlaceholder=y,e.value!==K&&(e.value=K,Ti(e,S))}}}function Ti(r,n){document.activeElement===r&&(Ei?Ri(()=>r.setSelectionRange(n,n,ai)):r.setSelectionRange(n,n,ai))}function Oi(r){if(si(r))return r;if(Si(r))return String(r);if(r==null)return pi;throw new Error(`The 'value' provided to Text Mask needs to be a string or a number. The value received was:

 ${JSON.stringify(r)}`)}var ki={provide:qt,useExisting:Rt(()=>De),multi:!0};function Fi(){let r=yt()?yt().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var De=(()=>{let n=class n{constructor(e,t,i){this._renderer=e,this._elementRef=t,this._compositionMode=i,this.textMaskConfig={mask:[],guide:!0,placeholderChar:"_",pipe:void 0,keepCharPositions:!1},this.onChange=a=>{},this.onTouched=()=>{},this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Fi())}ngOnChanges(e){this._setupMask(!0),this.textMaskInputElement!==void 0&&this.textMaskInputElement.update(this.inputElement.value)}writeValue(e){this._setupMask();let t=e??"";this._renderer.setProperty(this.inputElement,"value",t),this.textMaskInputElement!==void 0&&this.textMaskInputElement.update(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&(this._setupMask(),this.textMaskInputElement!==void 0&&(this.textMaskInputElement.update(e),e=this.inputElement.value,this.onChange(e)))}_setupMask(e=!1){this.inputElement||(this._elementRef.nativeElement.tagName.toUpperCase()==="INPUT"?this.inputElement=this._elementRef.nativeElement:this.inputElement=this._elementRef.nativeElement.getElementsByTagName("INPUT")[0]),this.inputElement&&e&&(this.textMaskInputElement=zi(Object.assign({inputElement:this.inputElement},this.textMaskConfig)))}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this._handleInput(e)}};n.\u0275fac=function(t){return new(t||n)(M(kt),M(Se),M(Yt,8))},n.\u0275dir=zt({type:n,selectors:[["","textMask",""]],hostBindings:function(t,i){t&1&&z("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},inputs:{textMaskConfig:[0,"textMask","textMaskConfig"]},exportAs:["textMask"],features:[Ht([ki]),je]});let r=n;return r})(),li=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Me({type:n}),n.\u0275inj=Ce({});let r=n;return r})();var Pi=["wrapper"],Vi=["sourceImage"];function Hi(r,n){if(r&1){let o=re();p(0,"img",5,1),z("load",function(){w(o);let t=x();return b(t.imageLoadedInView())})("mousedown",function(t){w(o);let i=x();return b(i.startMove(t,i.moveTypes.Drag))})("touchstart",function(t){w(o);let i=x();return b(i.startMove(t,i.moveTypes.Drag))})("error",function(t){w(o);let i=x();return b(i.loadImageError(t))}),c()}if(r&2){let o=x();te("visibility",o.imageVisible?"visible":"hidden")("transform",o.safeTransformStyle),qe("ngx-ic-draggable",!o.disabled&&o.allowMoveImage),h("src",o.safeImgDataUrl,U),vt("alt",o.imageAltText)}}function Bi(r,n){if(r&1){let o=re();Ft(0),p(1,"span",9),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"topleft"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"topleft"))}),g(2,"span",10),c(),p(3,"span",11),g(4,"span",10),c(),p(5,"span",12),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"topright"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"topright"))}),g(6,"span",10),c(),p(7,"span",13),g(8,"span",10),c(),p(9,"span",14),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottomright"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottomright"))}),g(10,"span",10),c(),p(11,"span",15),g(12,"span",10),c(),p(13,"span",16),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottomleft"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottomleft"))}),g(14,"span",10),c(),p(15,"span",17),g(16,"span",10),c(),p(17,"span",18),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"top"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"top"))}),c(),p(18,"span",19),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"right"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"right"))}),c(),p(19,"span",20),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottom"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"bottom"))}),c(),p(20,"span",21),z("mousedown",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"left"))})("touchstart",function(t){w(o);let i=x(2);return b(i.startMove(t,i.moveTypes.Resize,"left"))}),c(),Pt()}}function Ni(r,n){if(r&1){let o=re();p(0,"div",6),z("keydown",function(t){w(o);let i=x();return b(i.keyboardAccess(t))}),p(1,"div",7),z("mousedown",function(t){w(o);let i=x();return b(i.startMove(t,i.moveTypes.Move))})("touchstart",function(t){w(o);let i=x();return b(i.startMove(t,i.moveTypes.Move))}),c(),R(2,Bi,21,0,"ng-container",8),c()}if(r&2){let o=x();te("top",o.cropper.y1,"px")("left",o.cropper.x1,"px")("width",o.cropper.x2-o.cropper.x1,"px")("height",o.cropper.y2-o.cropper.y1,"px")("margin-left",o.alignImage==="center"?o.marginLeft:null)("visibility",o.imageVisible?"visible":"hidden"),qe("ngx-ic-round",o.roundCropper),vt("aria-label",o.cropperFrameAriaLabel),m(2),h("ngIf",!o.hideResizeSquares)}}var St=class{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(n){Object.keys(n).filter(o=>o in this).forEach(o=>this[o]=n[o]),this.validateOptions()}setOptionsFromChanges(n){Object.keys(n).filter(o=>o in this).forEach(o=>this[o]=n[o].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}},Y=function(r){return r.Drag="drag",r.Move="move",r.Resize="resize",r.Pinch="pinch",r}(Y||{});function Di(r){switch(r){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function Li(r){switch(r){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function Ui(r,n){switch(r){case"ArrowUp":return{clientX:0,clientY:n*-1};case"ArrowRight":return{clientX:n,clientY:0};case"ArrowDown":return{clientX:0,clientY:n};case"ArrowLeft":default:return{clientX:n*-1,clientY:0}}}function Wi(r,n,o){let e=r.width,t=r.height;n=Math.round(n),o=Math.round(o);let i=e/n,a=t/o,s=Math.ceil(i/2),l=Math.ceil(a/2),u=r.getContext("2d");if(u){let y=u.getImageData(0,0,e,t),v=u.createImageData(n,o),_=y.data,T=v.data;for(let A=0;A<o;A++)for(let H=0;H<n;H++){let B=(H+A*n)*4,N=A*a,C=0,I=0,O=0,f=0,S=0,X=0,V=0,K=Math.floor(H*i),ie=Math.floor(A*a),W=Math.ceil((H+1)*i),ee=Math.ceil((A+1)*a);W=Math.min(W,e),ee=Math.min(ee,t);for(let Fe=ie;Fe<ee;Fe++){let We=Math.abs(N-Fe)/l,ft=H*i,bt=We*We;for(let ye=K;ye<W;ye++){let Pe=Math.abs(ft-ye)/s,E=Math.sqrt(bt+Pe*Pe);if(E>=1)continue;C=2*E*E*E-3*E*E+1;let J=4*(ye+Fe*e);V+=C*_[J+3],O+=C,_[J+3]<255&&(C=C*_[J+3]/250),f+=C*_[J],S+=C*_[J+1],X+=C*_[J+2],I+=C}}T[B]=f/I,T[B+1]=S/I,T[B+2]=X/I,T[B+3]=V/O}r.width=n,r.height=o,u.putImageData(v,0,0)}}function di(r,n){return r/100*n}var ji=(()=>{let n=class n{crop(e,t,i,a,s){let l=this.getImagePosition(e,t,i,s),u=l.x2-l.x1,y=l.y2-l.y1,v=document.createElement("canvas");v.width=u,v.height=y;let _=v.getContext("2d");if(!_)return null;i.backgroundColor!=null&&(_.fillStyle=i.backgroundColor,_.fillRect(0,0,u,y));let T=(i.transform.scale||1)*(i.transform.flipH?-1:1),A=(i.transform.scale||1)*(i.transform.flipV?-1:1),{translateH:H,translateV:B}=this.getCanvasTranslate(e,i,s),N=e.transformed;_.setTransform(T,0,0,A,N.size.width/2+H,N.size.height/2+B),_.translate(-l.x1/T,-l.y1/A),_.rotate((i.transform.rotate||0)*Math.PI/180),_.drawImage(N.image,-N.size.width/2,-N.size.height/2);let C={width:u,height:y,imagePosition:l,cropperPosition:L({},t)};i.containWithinAspectRatio&&(C.offsetImagePosition=this.getOffsetImagePosition(e,t,i,s));let I=this.getResizeRatio(u,y,i);return I!==1&&(C.width=Math.round(u*I),C.height=i.maintainAspectRatio?Math.round(C.width/i.aspectRatio):Math.round(y*I),Wi(v,C.width,C.height)),a==="blob"?this.cropToBlob(C,v,i):(C.base64=v.toDataURL("image/"+i.format,this.getQuality(i)),C)}cropToBlob(e,t,i){return G(this,null,function*(){return e.blob=yield new Promise(a=>t.toBlob(a,"image/"+i.format,this.getQuality(i))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e,t,i){if(t.transform.translateUnit==="px"){let a=this.getRatio(e,i);return{translateH:(t.transform.translateH||0)*a,translateV:(t.transform.translateV||0)*a}}else return{translateH:t.transform.translateH?di(t.transform.translateH,e.transformed.size.width):0,translateV:t.transform.translateV?di(t.transform.translateV,e.transformed.size.height):0}}getRatio(e,t){return e.transformed.size.width/t.width}getImagePosition(e,t,i,a){let s=this.getRatio(e,a),l={x1:Math.round(t.x1*s),y1:Math.round(t.y1*s),x2:Math.round(t.x2*s),y2:Math.round(t.y2*s)};return i.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,e.transformed.size.width),l.y2=Math.min(l.y2,e.transformed.size.height)),l}getOffsetImagePosition(e,t,i,a){let s=i.canvasRotation+e.exifTransform.rotate,l=this.getRatio(e,a),u,y;s%2?(u=(e.transformed.size.width-e.original.size.height)/2,y=(e.transformed.size.height-e.original.size.width)/2):(u=(e.transformed.size.width-e.original.size.width)/2,y=(e.transformed.size.height-e.original.size.height)/2);let v={x1:Math.round(t.x1*l)-u,y1:Math.round(t.y1*l)-y,x2:Math.round(t.x2*l)-u,y2:Math.round(t.y2*l)-y};return i.containWithinAspectRatio||(v.x1=Math.max(v.x1,0),v.y1=Math.max(v.y1,0),v.x2=Math.min(v.x2,e.transformed.size.width),v.y2=Math.min(v.y2,e.transformed.size.height)),v}getResizeRatio(e,t,i){let a=i.resizeToWidth/e,s=i.resizeToHeight/t,l=new Array;i.resizeToWidth>0&&l.push(a),i.resizeToHeight>0&&l.push(s);let u=l.length===0?1:Math.min(...l);return u>1&&!i.onlyScaleDown?u:Math.min(u,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})(),Qi=(()=>{let n=class n{resetCropperPosition(e,t,i,a){if(e?.nativeElement)if(i.cropperStaticHeight&&i.cropperStaticWidth)t.x1=0,t.x2=a.width>i.cropperStaticWidth?i.cropperStaticWidth:a.width,t.y1=0,t.y2=a.height>i.cropperStaticHeight?i.cropperStaticHeight:a.height;else{let s=Math.min(i.cropperScaledMaxWidth,a.width),l=Math.min(i.cropperScaledMaxHeight,a.height);if(!i.maintainAspectRatio)t.x1=0,t.x2=s,t.y1=0,t.y2=l;else if(a.width/i.aspectRatio<a.height){t.x1=0,t.x2=s;let u=s/i.aspectRatio;t.y1=(a.height-u)/2,t.y2=t.y1+u}else{t.y1=0,t.y2=l;let u=l*i.aspectRatio;t.x1=(a.width-u)/2,t.x2=t.x1+u}}}move(e,t,i){let a=this.getClientX(e)-t.clientX,s=this.getClientY(e)-t.clientY;i.x1=t.x1+a,i.y1=t.y1+s,i.x2=t.x2+a,i.y2=t.y2+s}resize(e,t,i,a,s){let l=this.getClientX(e)-t.clientX,u=this.getClientY(e)-t.clientY;switch(t.position){case"left":i.x1=Math.min(Math.max(t.x1+l,i.x2-s.cropperScaledMaxWidth),i.x2-s.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(t.x1+l,i.x2-s.cropperScaledMaxWidth),i.x2-s.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+u,i.y2-s.cropperScaledMaxHeight),i.y2-s.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(t.y1+u,i.y2-s.cropperScaledMaxHeight),i.y2-s.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(t.x2+l,i.x1+s.cropperScaledMaxWidth),i.x1+s.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+u,i.y2-s.cropperScaledMaxHeight),i.y2-s.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(t.x2+l,i.x1+s.cropperScaledMaxWidth),i.x1+s.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(t.x2+l,i.x1+s.cropperScaledMaxWidth),i.x1+s.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+u,i.y1+s.cropperScaledMaxHeight),i.y1+s.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(t.y2+u,i.y1+s.cropperScaledMaxHeight),i.y1+s.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(t.x1+l,i.x2-s.cropperScaledMaxWidth),i.x2-s.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+u,i.y1+s.cropperScaledMaxHeight),i.y1+s.cropperScaledMinHeight);break;case"center":let y=e.scale,v=Math.min(Math.max(s.cropperScaledMinWidth,Math.abs(t.x2-t.x1)*y),s.cropperScaledMaxWidth),_=Math.min(Math.max(s.cropperScaledMinHeight,Math.abs(t.y2-t.y1)*y),s.cropperScaledMaxHeight);i.x1=t.clientX-v/2,i.x2=t.clientX+v/2,i.y1=t.clientY-_/2,i.y2=t.clientY+_/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>a.width&&(i.x1-=i.x2-a.width,i.x2=a.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>a.height&&(i.y1-=i.y2-a.height,i.y2=a.height);break}s.maintainAspectRatio&&this.checkAspectRatio(t.position,i,a,s)}checkAspectRatio(e,t,i,a){let s=0,l=0;switch(e){case"top":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,s=Math.max(t.x2-i.width,0),l=Math.max(0-t.y1,0),(s>0||l>0)&&(t.x2-=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y1+=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"bottom":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,s=Math.max(t.x2-i.width,0),l=Math.max(t.y2-i.height,0),(s>0||l>0)&&(t.x2-=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y2-=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"topleft":t.y1=t.y2-(t.x2-t.x1)/a.aspectRatio,s=Math.max(0-t.x1,0),l=Math.max(0-t.y1,0),(s>0||l>0)&&(t.x1+=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y1+=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"topright":t.y1=t.y2-(t.x2-t.x1)/a.aspectRatio,s=Math.max(t.x2-i.width,0),l=Math.max(0-t.y1,0),(s>0||l>0)&&(t.x2-=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y1+=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"right":case"bottomright":t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio,s=Math.max(t.x2-i.width,0),l=Math.max(t.y2-i.height,0),(s>0||l>0)&&(t.x2-=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y2-=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"left":case"bottomleft":t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio,s=Math.max(0-t.x1,0),l=Math.max(t.y2-i.height,0),(s>0||l>0)&&(t.x1+=l*a.aspectRatio>s?l*a.aspectRatio:s,t.y2-=l*a.aspectRatio>s?l:s/a.aspectRatio);break;case"center":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio;let u=Math.max(0-t.x1,0),y=Math.max(t.x2-i.width,0),v=Math.max(t.y2-i.height,0),_=Math.max(0-t.y1,0);(u>0||y>0||v>0||_>0)&&(t.x1+=v*a.aspectRatio>u?v*a.aspectRatio:u,t.x2-=_*a.aspectRatio>y?_*a.aspectRatio:y,t.y1+=_*a.aspectRatio>y?_:y/a.aspectRatio,t.y2-=v*a.aspectRatio>u?v:u/a.aspectRatio);break}}getClientX(e){return"touches"in e&&e.touches[0]?e.touches[0].clientX:"clientX"in e?e.clientX:0}getClientY(e){return"touches"in e&&e.touches[0]?e.touches[0].clientY:"clientX"in e?e.clientY:0}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})(),qi="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==";function Yi(){return new Promise(r=>{let n=new Image;n.onload=()=>{let o=n.width===1&&n.height===2;r(o)},n.src=qi})}function Xi(r){switch(typeof r=="object"&&(r=Gi(r)),r){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Gi(r){let n=new DataView(r);if(n.getUint16(0,!1)!==65496)return-2;let o=n.byteLength,e=2;for(;e<o;){if(n.getUint16(e+2,!1)<=8)return-1;let t=n.getUint16(e,!1);if(e+=2,t==65505){if(n.getUint32(e+=2,!1)!==1165519206)return-1;let i=n.getUint16(e+=6,!1)==18761;e+=n.getUint32(e+4,i);let a=n.getUint16(e,i);e+=2;for(let s=0;s<a;s++)if(n.getUint16(e+s*12,i)==274)return n.getUint16(e+s*12+8,i)}else{if((t&65280)!==65280)break;e+=n.getUint16(e,!1)}}return-1}var Ki=(()=>{let n=class n{constructor(){this.autoRotateSupported=Yi()}loadImageFile(e,t){return G(this,null,function*(){let i=yield e.arrayBuffer();return yield this.checkImageTypeAndLoadImageFromArrayBuffer(i,e.type,t)})}checkImageTypeAndLoadImageFromArrayBuffer(e,t,i){return this.isValidImageType(t)?this.loadImageFromArrayBuffer(e,i,t):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return G(this,null,function*(){let a=yield(yield fetch(e)).blob(),s=yield a.arrayBuffer();return yield this.loadImageFromArrayBuffer(s,t,a.type)})}loadBase64Image(e,t){let i=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(i,t)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let t=atob(e),i=t.length,a=new Uint8Array(i);for(let s=0;s<i;s++)a[s]=t.charCodeAt(s);return a.buffer}loadImageFromArrayBuffer(e,t,i){return G(this,null,function*(){let a=yield new Promise((s,l)=>G(this,null,function*(){try{let u=new Blob([e],i?{type:i}:void 0),y=URL.createObjectURL(u),v=new Image,T=i==="image/svg+xml"?yield this.getSvgImageSize(u):void 0;v.onload=()=>s({originalImage:v,originalImageSize:T,originalObjectUrl:y,originalArrayBuffer:e}),v.onerror=l,v.src=y}catch(u){l(u)}}));return yield this.transformImageFromArrayBuffer(a,t,a.originalImageSize!=null)})}getSvgImageSize(e){return G(this,null,function*(){let a=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!a)throw Error("Failed to parse SVG image");let s=a.getAttribute("width"),l=a.getAttribute("height");if(s&&l)return null;let u=a.getAttribute("viewBox")||a.getAttribute("viewbox");if(u){let y=u.split(" ");return{width:+y[2],height:+y[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,t,i=!1){return G(this,null,function*(){let a=yield this.autoRotateSupported,s=Xi(a?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let l={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:s};return this.transformLoadedImage(l,t,i)})}transformLoadedImage(e,t,i=!1){return G(this,null,function*(){let a=t.canvasRotation+e.exifTransform.rotate,s=e.original.size;if(!i&&a===0&&!e.exifTransform.flip&&!t.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:L({},s)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:L({},s)},exifTransform:e.exifTransform};let l=this.getTransformedSize(s,e.exifTransform,t),u=document.createElement("canvas");u.width=l.width,u.height=l.height;let y=u.getContext("2d");y?.setTransform(e.exifTransform.flip?-1:1,0,0,1,u.width/2,u.height/2),y?.rotate(Math.PI*(a/2)),y?.drawImage(e.original.image,-s.width/2,-s.height/2);let v=yield new Promise(A=>u.toBlob(A,t.format));if(!v)throw new Error("Failed to get Blob for transformed image.");let _=URL.createObjectURL(v),T=yield this.loadImageFromObjectUrl(_);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:L({},s)},transformed:{objectUrl:_,image:T,size:{width:T.width,height:T.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((t,i)=>{let a=new Image;a.onload=()=>t(a),a.onerror=i,a.src=e})}getTransformedSize(e,t,i){let a=i.canvasRotation+t.rotate;if(i.containWithinAspectRatio)if(a%2){let s=e.width*i.aspectRatio,l=e.height/i.aspectRatio;return{width:Math.max(e.height,s),height:Math.max(e.width,l)}}else{let s=e.height*i.aspectRatio,l=e.width/i.aspectRatio;return{width:Math.max(e.width,s),height:Math.max(e.height,l)}}return a%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})(),ut=(()=>{let n=class n{constructor(e,t,i,a,s,l,u){this.cropService=e,this.cropperPositionService=t,this.loadImageService=i,this.sanitizer=a,this.cd=s,this.zone=l,this.hammerLoader=u,this.settings=new St,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=Y,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new he,this.startCropImage=new he,this.imageLoaded=new he,this.cropperReady=new he,this.loadImageFailed=new he,this.transformChange=new he,this.reset()}ngOnChanges(e){this.onChangesUpdateSettings(e),this.onChangesInputImage(e),this.loadedImage?.original.image.complete&&(e.containWithinAspectRatio||e.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(e.cropper||e.maintainAspectRatio||e.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(this.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(e.maintainAspectRatio||e.aspectRatio)?this.resetCropperPosition():e.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop())),e.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(e){this.settings.setOptionsFromChanges(e),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){let e=this.imageChangedEvent?.target?.files;return e instanceof FileList&&e.length>0}setCssTransform(){let e=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${e}, ${this.transform.translateV||0}${e}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(e){this.loadImageService.loadImageFile(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.loadedImage=e,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl),this.cd.markForCheck()}loadImageError(e){console.error(e),this.loadImageFailed.emit()}imageLoadedInView(){this.loadedImage!=null&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(L({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=L({},this.maxSize);this.setMaxSize(),this.resizeCropperPosition(e),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){return G(this,null,function*(){yield this.hammerLoader?.();let e=window?.Hammer||null;if(e){let t=new e(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else Dt()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})}resizeCropperPosition(e){(e.width!==this.maxSize.width||e.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/e.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/e.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/e.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/e.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.settings.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let i=e.shiftKey?Y.Resize:Y.Move,a=e.altKey?Li(e.key):Di(e.key),s=Ui(e.key,this.settings.stepSize);e.preventDefault(),e.stopPropagation(),this.startMove({clientX:0,clientY:0},i,a),this.handleMouseMove(s),this.handleMouseUp()}startMove(e,t,i=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===Y.Pinch||t===Y.Drag&&!this.allowMoveImage||("preventDefault"in e&&e.preventDefault(),this.moveStart=L({active:!0,type:t,position:i,transform:L({},this.transform),clientX:this.cropperPositionService.getClientX(e),clientY:this.cropperPositionService.getClientY(e)},this.cropper),this.initMouseMove())}initMouseMove(){xt(Ve(document,"mousemove"),Ve(document,"touchmove")).pipe(Et(xt(Ve(document,"mouseup"),Ve(document,"touchend")).pipe(It()))).subscribe({next:e=>this.zone.run(()=>{this.handleMouseMove(e),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(e){this.safeImgDataUrl&&(e.preventDefault&&e.preventDefault(),this.moveStart=L({active:!0,type:Y.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}handleMouseMove(e){if(this.moveStart.active){if("stopPropagation"in e&&e.stopPropagation(),"preventDefault"in e&&e.preventDefault(),this.moveStart.type===Y.Move)this.cropperPositionService.move(e,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===Y.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===Y.Drag){let t=this.cropperPositionService.getClientX(e)-this.moveStart.clientX,i=this.cropperPositionService.getClientY(e)-this.moveStart.clientY;this.transform=At(L({},this.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+i}),this.setCssTransform()}}}onPinch(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===Y.Pinch&&(this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(e.width),this.maxSize.height=parseFloat(e.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.maintainAspectRatio?this.settings.cropperScaledMinHeight=Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?this.settings.cropperScaledMinHeight=Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):this.settings.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){let e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(e=!1){this.cropper.x1<0&&(this.cropper.x2-=e?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=e?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=e?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=e?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===Y.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(e=this.settings.output){if(this.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>this.zone.run(()=>G(this,null,function*(){let i=yield this.cropService.crop(this.loadedImage,this.cropper,this.settings,"blob",this.maxSize);i?(this.imageCropped.emit(i),e(i)):t("Crop image failed")})))}cropToBase64(){let e=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return e?(this.imageCropped.emit(e),e):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}};n.\u0275fac=function(t){return new(t||n)(M(ji),M(Qi),M(Ki),M(Ae),M(Lt),M(Tt),M(jt,8))},n.\u0275cmp=D({type:n,selectors:[["image-cropper"]],viewQuery:function(t,i){if(t&1&&(ue(Pi,7),ue(Vi,5)),t&2){let a;ge(a=fe())&&(i.wrapper=a.first),ge(a=fe())&&(i.sourceImage=a.first)}},hostVars:6,hostBindings:function(t,i){t&1&&z("resize",function(){return i.onResize()},!1,Ot),t&2&&(te("text-align",i.alignImage),qe("disabled",i.disabled)("ngx-ix-hidden",i.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},standalone:!0,features:[je,Bt],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){t&1&&(p(0,"div",null,0),R(2,Hi,2,8,"img",2),g(3,"div",3),R(4,Ni,3,16,"div",4),c()),t&2&&(te("background",i.imageVisible&&i.backgroundColor),m(2),h("ngIf",i.safeImgDataUrl),m(),te("width",i.maxSize.width,"px")("height",i.maxSize.height,"px")("margin-left",i.alignImage==="center"?i.marginLeft:null),m(),h("ngIf",i.imageVisible))},dependencies:[be],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0});let r=n;return r})();var Le=r=>({"is-invalid":r}),Zi=r=>({mask:r});function er(r,n){if(r&1&&(p(0,"li"),d(1),c()),r&2){let o=n.$implicit;m(),ne(o)}}function tr(r,n){if(r&1&&(p(0,"div",24)(1,"h3",25),d(2,"Oops! Something isn't right:"),c(),p(3,"ul"),R(4,er,2,1,"li",26),c()()),r&2){let o=x();m(4),h("ngForOf",o.errors)}}function ir(r,n){if(r&1&&(p(0,"option",27),d(1),c()),r&2){let o=n.$implicit;Ye("value",o.id),m(),ne(o.name)}}function rr(r,n){if(r&1&&(p(0,"span",28),g(1,"p",29),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.supplierId,j)}}function nr(r,n){if(r&1&&(p(0,"span",28),g(1,"p",29),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.name,j)}}function ar(r,n){if(r&1&&(p(0,"span",28),g(1,"p",29),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.description,j)}}function or(r,n){if(r&1&&(p(0,"span"),g(1,"br"),d(2),g(3,"br"),c()),r&2){let o=x();m(2),ne(o.cropperSettings.imageName)}}function sr(r,n){if(r&1&&(p(0,"span",28),g(1,"p",29),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.image,j)}}function cr(r,n){if(r&1){let o=re();p(0,"div",1)(1,"div",30)(2,"image-cropper",31),z("imageCropped",function(t){w(o);let i=x();return b(i.imageCropped(t))})("imageLoaded",function(){w(o);let t=x();return b(t.imageLoaded())})("cropperReady",function(t){w(o);let i=x();return b(i.cropperReady(t))})("loadImageFailed",function(){w(o);let t=x();return b(t.loadImageFailed())}),c()(),p(3,"div",30),g(4,"img",32),c()()}if(r&2){let o=x();m(2),te("display",o.cropperSettings.showCropper?null:"none"),h("imageChangedEvent",o.cropperSettings.imageChangedEvent)("maintainAspectRatio",!1)("containWithinAspectRatio",o.cropperSettings.containWithinAspectRatio)("aspectRatio",4/3)("resizeToWidth",256)("cropperMinWidth",128)("onlyScaleDown",!0)("output",o.cropperSettings.output)("roundCropper",!1)("canvasRotation",o.cropperSettings.canvasRotation)("transform",o.cropperSettings.transform)("alignImage","left"),m(2),te("border",o.cropperSettings.croppedImage?"1px solid black":"none"),h("src",o.cropperSettings.croppedImage,U)}}function pr(r,n){if(r&1&&(p(0,"span",28),g(1,"p",29),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.value,j)}}var gi=(()=>{let n=class n extends ze{constructor(e,t,i,a,s,l){super(),this.formBuilder=e,this.productService=t,this.route=i,this.router=a,this.toastr=s,this.sanitizer=l,this.cropperSettings=new Re}ngOnInit(){this.productService.getSuppliers().pipe($(e=>e.map(t=>new lt(t)))).subscribe({next:e=>{this.suppliers=e},error:e=>this.errorMessage}),this.productForm=this.formBuilder.group({supplierId:["",[P.required]],name:["",[P.required,P.minLength(2),P.maxLength(200)]],description:["",[P.required,P.minLength(2),P.maxLength(1e3)]],image:["",[P.required]],value:["",[P.required]],active:[0]})}ngAfterViewInit(){super.configurateValidationForm(this.formInputElements)}createProduct(){if(this.productForm.dirty&&this.productForm.valid){this.changesNotSaved=!1,this.product=Object.assign({},this.product,this.productForm.value),this.product.imageUpload=this.cropperSettings.croppedImage.split(",")[1];let e=this.cropperSettings.imageName.split(".");this.product.image=this.cropperSettings.imageName.substring(0,20)+"."+e[e.length-1],this.product.value=Be.convertToNumber(this.productForm.get("value")?.value),console.log(this.product),this.productService.registerProduct(new pt(this.product)).subscribe({next:t=>{this.processSuccess(t)},error:t=>{this.procesError(t)}})}}processSuccess(e){this.errors=[];let t=this.toastr.success("product inserted successfully!","Successfully!");this.changesNotSaved=!1,t&&t.onHidden.subscribe(()=>{this.router.navigate(["/product/list"])})}procesError(e){this.errors=e.error.errors,this.toastr.error("An error occurred ","Oops :'(")}fileChangeEvent(e){this.cropperSettings.imageChangedEvent=e;let t=e.target;t&&t.files&&(this.cropperSettings.imageName=t.files[0].name)}imageCropped(e){e.objectUrl&&(this.cropperSettings.imageUrl=this.sanitizer.bypassSecurityTrustUrl(e.objectUrl)),this.cropperSettings.croppedImage=e.base64}imageLoaded(){this.cropperSettings.showCropper=!0}cropperReady(e){console.log("Cropper ready",e)}loadImageFailed(){this.errors.push(`The ${this.cropperSettings.imageName} file format isn't valid.`)}};n.\u0275fac=function(t){return new(t||n)(M(ct),M(q),M(se),M(ce),M(Ie),M(Ae))},n.\u0275cmp=D({type:n,selectors:[["app-product-register"]],viewQuery:function(t,i){if(t&1&&ue(pe,5,Se),t&2){let a;ge(a=fe())&&(i.formInputElements=a)}},features:[Qe],decls:50,vars:28,consts:[[1,"container","main-container"],[1,"row"],[1,"col-md-10"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],["for","supplierId",1,"control-label"],["id","supplierId","formControlName","supplierId",1,"form-control",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"control-label"],["id","name","type","text","placeholder","Name (required)","formControlName","name",1,"form-control",3,"ngClass"],["cols","40","rows","5","maxlength","1000","id","description","placeholder","Description (required)","formControlName","description",1,"form-control",3,"ngClass"],[1,"custom-file"],["aria-label","image","type","file","id","image","accept","image/png,image/jpg","formControlName","image",1,"custom-file-input",3,"change","ngClass"],["data-browse","Search",1,"custom-file-label",2,"width","400px"],[4,"ngIf"],["class","row",4,"ngIf"],["id","value","type","text","placeholder","Value (required)","formControlName","value",1,"form-control",3,"textMask","ngClass"],[1,"form-group","form-check"],[1,"form-check-label"],["type","checkbox","id","active","formControlName","active","name","active","value","true",1,"form-check-input"],["type","submit","id","product-register","value","Register",1,"btn","btn-primary"],["href","/product/list",1,"btn","btn-info"],[1,"alert","alert-danger"],["id","msgRetorno"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger"],[3,"innerHTML"],[1,"col","col-md-6"],["format","png",3,"imageCropped","imageLoaded","cropperReady","loadImageFailed","imageChangedEvent","maintainAspectRatio","containWithinAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth","onlyScaleDown","output","roundCropper","canvasRotation","transform","alignImage"],["aria-label","img",3,"src"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"h3"),d(2,"New Product "),c(),g(3,"hr"),p(4,"div",1)(5,"div",2)(6,"form",3),z("ngSubmit",function(){return i.createProduct()}),R(7,tr,5,1,"div",4),p(8,"div",5)(9,"label",6),d(10,"Supplier"),c(),p(11,"select",7),R(12,ir,2,2,"option",8),c(),R(13,rr,2,1,"span",9),c(),p(14,"div",5)(15,"label",10),d(16,"Name"),c(),p(17,"div"),g(18,"input",11),R(19,nr,2,1,"span",9),c()(),p(20,"div",5)(21,"label",10),d(22,"Description"),c(),p(23,"div"),g(24,"textarea",12),R(25,ar,2,1,"span",9),c()(),p(26,"div",5)(27,"label",10),d(28,"Image from Product"),c(),p(29,"div",13)(30,"input",14),z("change",function(s){return i.fileChangeEvent(s)}),c(),g(31,"label",15),R(32,or,4,1,"span",16)(33,sr,2,1,"span",9),c(),R(34,cr,5,17,"div",17),c(),p(35,"div",5)(36,"label",10),d(37,"Value"),c(),p(38,"div"),g(39,"input",18),R(40,pr,2,1,"span",9),c()(),p(41,"div",19)(42,"label",20),g(43,"input",21),d(44," Active? "),c()(),p(45,"div",5),g(46,"input",22),d(47,"\xA0 "),p(48,"a",23),d(49,"Back"),c()()()()()()),t&2&&(m(6),h("formGroup",i.productForm),m(),h("ngIf",i.errors.length>0),m(4),h("ngClass",F(16,Le,i.displayMessage.supplierId)),m(),h("ngForOf",i.suppliers),m(),h("ngIf",i.displayMessage.supplierId),m(5),h("ngClass",F(18,Le,i.displayMessage.name)),m(),h("ngIf",i.displayMessage.name),m(5),h("ngClass",F(20,Le,i.displayMessage.description)),m(),h("ngIf",i.displayMessage.description),m(5),h("ngClass",F(22,Le,i.displayMessage.image)),m(2),h("ngIf",i.cropperSettings.imageName),m(),h("ngIf",i.displayMessage.image),m(),h("ngIf",i.cropperSettings.imageName),m(5),h("textMask",F(24,Zi,i.MASKS.currency.textMask))("ngClass",F(26,Le,i.displayMessage.value)),m(),h("ngIf",i.displayMessage.value))},dependencies:[Ge,we,be,it,at,ot,Ze,$e,nt,et,tt,st,rt,pe,De,ut]});let r=n;return r})();var mr=()=>["/product/register"],dr=r=>["/product/details",r],hr=r=>["/product/edit",r],ur=r=>["/product/delete",r];function gr(r,n){if(r&1&&(p(0,"tr")(1,"td"),g(2,"img",7),c(),p(3,"td"),d(4),c(),p(5,"td"),d(6),c(),p(7,"td"),d(8),ae(9,"currencyBrazil"),c(),p(10,"td"),g(11,"input",8),c(),p(12,"td",9)(13,"a",10),g(14,"span",11),c(),d(15,"\xA0 "),p(16,"a",3),g(17,"span",12),c(),d(18,"\xA0 "),p(19,"a",13),g(20,"span",14),c()()()),r&2){let o=n.$implicit,e=x();m(2),h("src",e.images+o.image,U),m(2),k(" ",o.name," "),m(2),k(" ",o.supplierName," "),m(2),k(" ",oe(9,8,o.value,2)," "),m(3),h("checked",o.active),m(2),h("routerLink",F(11,dr,o.id)),m(3),h("routerLink",F(13,hr,o.id)),m(3),h("routerLink",F(15,ur,o.id))}}var fi=(()=>{let n=class n{constructor(e,t){this.productService=e,this.spinnerServ=t,this.MASKS=mt,this.images=le.apiImagesUrlv1,this.spinnerServ.show()}ngOnInit(){this.productService.getAll().pipe($(e=>e.map(t=>new me(t)))).subscribe({next:e=>{this.products=e,this.spinnerServ.hide()},error:e=>this.errorMessage})}};n.\u0275fac=function(t){return new(t||n)(M(q),M(dt))},n.\u0275cmp=D({type:n,selectors:[["app-product-list"]],decls:25,vars:4,consts:[[1,"container","main-container"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","pacman",3,"fullScreen"],[2,"color","white"],[1,"btn","btn-info",3,"routerLink"],[1,"table","table-hover"],[1,"thead-dark"],[4,"ngFor","ngForOf"],["alt","",2,"width","70px","height","100px",3,"src"],["aria-label","active","disabled","disabled","type","checkbox",1,"check-box",3,"checked"],[1,"text-right"],[1,"btn","btn-warning",3,"routerLink"],[1,"fa","fa-search"],[1,"fa","fa-pencil-alt"],[1,"btn","btn-danger",3,"routerLink"],[1,"fa","fa-trash"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"ngx-spinner",1)(2,"p",2),d(3," Loading... "),c()(),p(4,"h1"),d(5,"List of Products"),c(),g(6,"hr"),p(7,"p")(8,"a",3),d(9,"New Product"),c()(),p(10,"table",4)(11,"thead",5)(12,"tr"),g(13,"th"),p(14,"th"),d(15," Name "),c(),p(16,"th"),d(17," Supplier "),c(),p(18,"th"),d(19," Value "),c(),p(20,"th"),d(21," Active? "),c(),g(22,"th"),c()(),p(23,"tbody"),R(24,gr,21,17,"tr",6),c()()()),t&2&&(m(),h("fullScreen",!0),m(7),h("routerLink",Nt(3,mr)),m(16),h("ngForOf",i.products))},dependencies:[Je,we,ht,Ee]});let r=n;return r})();var fr=r=>["/product/edit",r],xi=(()=>{let n=class n{constructor(e){this.route=e,this.imagens=le.apiImagesUrlv1,this.product=new me(this.route.snapshot.data.product)}};n.\u0275fac=function(t){return new(t||n)(M(se))},n.\u0275cmp=D({type:n,selectors:[["app-product-details"]],decls:43,vars:19,consts:[[1,"container","main-container"],[1,"row"],[1,"col-md-4"],["alt","img",2,"width","300px","height","428px",3,"src"],[1,"col-md-6"],["aria-label","active","disabled","disabled","type","checkbox",1,"check-box",3,"checked"],[1,"btn","btn-warning",3,"routerLink"],["href","javascript:window.history.back();",1,"btn","btn-info"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"h1"),d(2),c(),g(3,"br"),p(4,"h4"),d(5,"Readonly Informations"),c(),p(6,"div",1)(7,"div",2),g(8,"img",3),c(),p(9,"div",4)(10,"dl")(11,"dt"),d(12," Supplier "),c(),p(13,"dd"),d(14),c(),p(15,"dt"),d(16," Name "),c(),p(17,"dd"),d(18),c(),p(19,"dt"),d(20," Description "),c(),p(21,"dd"),d(22),c(),p(23,"dt"),d(24," Value "),c(),p(25,"dd"),d(26),ae(27,"currencyBrazil"),c(),p(28,"dt"),d(29," Registration date "),c(),p(30,"dd"),d(31),ae(32,"date"),c(),p(33,"dt"),d(34," Active? "),c(),p(35,"dd"),g(36,"input",5),c()(),p(37,"div")(38,"a",6),d(39,"Edit"),c(),d(40,"\xA0 "),p(41,"a",7),d(42,"Back"),c()()()()()),t&2&&(m(2),k("Details product: ",i.product.name,""),m(6),Xe("src","",i.imagens,"",i.product.image,"",U),m(6),k(" ",i.product.supplierName," "),m(4),k(" ",i.product.name," "),m(4),k(" ",i.product.description," "),m(4),k(" ",oe(27,11,i.product.value,2)," "),m(5),k(" ",oe(32,14,i.product.registrationDate,"dd/MM/yyyy")," "),m(5),h("checked",i.product.active),m(2),h("routerLink",F(17,fr,i.product.id)))},dependencies:[Je,Ke,Ee]});let r=n;return r})();var Ue=r=>({"is-invalid":r}),xr=r=>({mask:r});function vr(r,n){if(r&1&&(p(0,"li"),d(1),c()),r&2){let o=n.$implicit;m(),ne(o)}}function yr(r,n){if(r&1&&(p(0,"div",27)(1,"h3",28),d(2,"Oops! Something isn't right:"),c(),p(3,"ul"),R(4,vr,2,1,"li",29),c()()),r&2){let o=x();m(4),h("ngForOf",o.errors)}}function Cr(r,n){if(r&1&&(p(0,"option",30),d(1),c()),r&2){let o=n.$implicit;Ye("value",o.id),m(),ne(o.name)}}function _r(r,n){if(r&1&&(p(0,"span",31),g(1,"p",32),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.supplierId,j)}}function Mr(r,n){if(r&1&&(p(0,"span",31),g(1,"p",32),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.name,j)}}function Sr(r,n){if(r&1&&(p(0,"span",31),g(1,"p",32),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.description,j)}}function wr(r,n){if(r&1&&(p(0,"div",8)(1,"label"),d(2,"Currently Image"),c(),g(3,"br")(4,"img",33),c()),r&2){let o=x();m(4),h("src",o.currentlyImageSrc,U)}}function br(r,n){if(r&1&&(p(0,"div",8)(1,"label"),d(2,"New Image"),c(),g(3,"br")(4,"img",33),c()),r&2){let o=x();m(4),h("src",o.imgProperties.imageUrl,U)}}function Ar(r,n){if(r&1&&(p(0,"span"),g(1,"br"),d(2),g(3,"br"),c()),r&2){let o=x();m(2),ne(o.imgProperties.imageName)}}function Ir(r,n){if(r&1&&(p(0,"span",31),g(1,"p",32),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.image,j)}}function Er(r,n){if(r&1&&(p(0,"span",31),g(1,"p",32),c()),r&2){let o=x();m(),h("innerHTML",o.displayMessage.value,j)}}var vi=(()=>{let n=class n extends ze{constructor(e,t,i,a,s,l,u){super(),this.formBuilder=e,this.productService=t,this.route=i,this.router=a,this.toastr=s,this.spinnerServ=l,this.sanitizer=u,this.images=le.apiImagesUrlv1,this.imgProperties=new Re,this.spinnerServ.show(),this.product=new me(this.route.snapshot.data.product),this.imgProperties.imageName=this.product.image,this.currentlyImageSrc=this.images+this.product.image}ngOnInit(){this.productService.getSuppliers().pipe($(e=>e.map(t=>new lt(t)))).subscribe({next:e=>{this.suppliers=e,this.spinnerServ.hide()},error:e=>this.errorMessage}),this.productForm=this.formBuilder.group({supplierId:["",[P.required]],name:["",[P.required,P.minLength(2),P.maxLength(200)]],description:["",[P.required,P.minLength(2),P.maxLength(1e3)]],image:[""],value:[0,[P.required]],active:[0]}),this.productForm.patchValue({supplierId:this.product.supplierId,id:this.product.id,name:this.product.name,description:this.product.description,active:this.product.active,value:Be.DecimalToString(this.product.value)})}ngAfterViewInit(){super.configurateValidationForm(this.formInputElements)}editProduct(){if(this.productForm.dirty&&this.productForm.valid){if(this.changesNotSaved=!1,this.product=Object.assign({},this.product,this.productForm.value),console.log(this.imgProperties.croppedImage),this.imgProperties.croppedImage){this.product.imageUpload=this.imgProperties.croppedImage;let e=this.imgProperties.imageName.split(".");this.product.image=e.length>20?this.imgProperties.imageName.substring(0,20)+"."+e[e.length-1]:this.imgProperties.imageName}this.product.value=Be.convertToNumber(this.productForm.get("value")?.value+""),console.log(this.product),this.productService.updateProduct(new pt(this.product)).subscribe({next:e=>{this.processSuccess(e)},error:e=>{this.procesError(e)}})}}processSuccess(e){this.errors=[];let t=this.toastr.success("Product update successfully!","Successfully!");this.changesNotSaved=!1,t&&t.onHidden.subscribe(()=>{this.router.navigate(["/product/list"])})}procesError(e){this.errors=e.error.errors,this.toastr.error("An error occurred ","Oops :'(")}upload(e){this.imgProperties.imageName=e[0].name;var t=new FileReader;t.onload=this.readerProcessflow.bind(this),t.readAsBinaryString(e[0])}readerProcessflow(e){var t=e.target.result;this.imgProperties.croppedImage=btoa(t),this.imgProperties.imageUrl="data:image/jpeg;base64,"+this.imgProperties.croppedImage}};n.\u0275fac=function(t){return new(t||n)(M(ct),M(q),M(se),M(ce),M(Ie),M(dt),M(Ae))},n.\u0275cmp=D({type:n,selectors:[["app-product-edit"]],viewQuery:function(t,i){if(t&1&&ue(pe,5,Se),t&2){let a;ge(a=fe())&&(i.formInputElements=a)}},features:[Qe],decls:55,vars:32,consts:[["fileInput",""],[1,"container","main-container"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","pacman",3,"fullScreen"],[2,"color","white"],[1,"row"],[1,"col-md-10"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],["for","supplierId",1,"control-label"],["id","supplierId","formControlName","supplierId",1,"form-control",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"control-label"],["id","name","type","text","placeholder","Name (required)","formControlName","name",1,"form-control",3,"ngClass"],["cols","40","rows","5","maxlength","1000","id","description","placeholder","Description (required)","formControlName","description",1,"form-control",3,"ngClass"],["class","form-group",4,"ngIf"],[1,"custom-file"],["aria-label","image","type","file","id","image","accept","image/png,image/jpg","formControlName","image",1,"custom-file-input",3,"change","ngClass"],["data-browse","Search",1,"custom-file-label",2,"width","400px"],[4,"ngIf"],["id","value","type","text","placeholder","Value (required)","formControlName","value","currency","",1,"form-control",3,"textMask","ngClass"],[1,"form-group","form-check"],[1,"form-check-label"],["type","checkbox","id","active","formControlName","active","name","active","value","true",1,"form-check-input"],["type","submit","value","Edit",1,"btn","btn-primary",3,"disabled"],["href","/product/list",1,"btn","btn-info"],[1,"alert","alert-danger"],["id","msgRetorno"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger"],[3,"innerHTML"],["aria-label","img",2,"width","70px","height","100px",3,"src"]],template:function(t,i){if(t&1){let a=re();p(0,"div",1)(1,"ngx-spinner",2)(2,"p",3),d(3," Loading... "),c()(),p(4,"h3"),d(5),c(),g(6,"hr"),p(7,"div",4)(8,"div",5)(9,"form",6),z("ngSubmit",function(){return w(a),b(i.editProduct())}),R(10,yr,5,1,"div",7),p(11,"div",8)(12,"label",9),d(13,"Supplier"),c(),p(14,"select",10),R(15,Cr,2,2,"option",11),c(),R(16,_r,2,1,"span",12),c(),p(17,"div",8)(18,"label",13),d(19,"Name"),c(),p(20,"div"),g(21,"input",14),R(22,Mr,2,1,"span",12),c()(),p(23,"div",8)(24,"label",13),d(25,"Description"),c(),p(26,"div"),g(27,"textarea",15),R(28,Sr,2,1,"span",12),c()(),R(29,wr,5,1,"div",16)(30,br,5,1,"div",16),p(31,"div",8)(32,"label",13),d(33,"Image From Product"),c(),p(34,"div",17)(35,"input",18,0),z("change",function(){w(a);let l=Vt(36);return b(i.upload(l.files))}),c(),g(37,"label",19),R(38,Ar,4,1,"span",20)(39,Ir,2,1,"span",12),c()(),p(40,"div",8)(41,"label",13),d(42,"Value"),c(),p(43,"div"),g(44,"input",21),R(45,Er,2,1,"span",12),c()(),p(46,"div",22)(47,"label",23),g(48,"input",24),d(49," Active? "),c()(),p(50,"div",8),g(51,"input",25),d(52,"\xA0 "),p(53,"a",26),d(54,"Back"),c()()()()()()}t&2&&(m(),h("fullScreen",!0),m(4),k("Edit Product - ",i.product.name,""),m(4),h("formGroup",i.productForm),m(),h("ngIf",i.errors.length>0),m(4),h("ngClass",F(20,Ue,i.displayMessage.supplierId)),m(),h("ngForOf",i.suppliers),m(),h("ngIf",i.displayMessage.supplierId),m(5),h("ngClass",F(22,Ue,i.displayMessage.name)),m(),h("ngIf",i.displayMessage.name),m(5),h("ngClass",F(24,Ue,i.displayMessage.description)),m(),h("ngIf",i.displayMessage.description),m(),h("ngIf",!i.imgProperties.imageUrl),m(),h("ngIf",i.imgProperties.imageUrl),m(5),h("ngClass",F(26,Ue,i.displayMessage.image)),m(3),h("ngIf",i.imgProperties.imageName),m(),h("ngIf",i.displayMessage.image),m(5),h("textMask",F(28,xr,i.MASKS.currency.textMask))("ngClass",F(30,Ue,i.displayMessage.value)),m(),h("ngIf",i.displayMessage.value),m(6),h("disabled",!i.productForm.valid))},dependencies:[Ge,we,be,it,at,ot,Ze,$e,nt,et,tt,st,rt,pe,$t,ht,De]});let r=n;return r})();var yi=(()=>{let n=class n{constructor(e,t,i,a){this.produtoService=e,this.route=t,this.router=i,this.toastr=a,this.imagens=le.apiImagesUrlv1,this.product=new me(this.route.snapshot.data.product)}eraseProduct(){this.produtoService.deleteProduct(this.product.id).subscribe({next:e=>{this.successExclusion(e)},error:()=>{this.failure()}})}successExclusion(e){let t=this.toastr.success("Product successfully deleted!","Good bye :D");t&&t.onHidden.subscribe(()=>{this.router.navigate(["/product/list"])})}failure(){this.toastr.error("There was a processing error!","Oops! :(")}};n.\u0275fac=function(t){return new(t||n)(M(q),M(se),M(ce),M(Ie))},n.\u0275cmp=D({type:n,selectors:[["app-product-delete"]],decls:43,vars:16,consts:[[1,"container","main-container"],[1,"row"],[1,"col-md-4"],["alt","img",2,"width","300px","height","428px",3,"src"],[1,"col-md-6"],["aria-label","active","disabled","disabled","type","checkbox",1,"check-box",3,"checked"],["href","javascript:void(0)",1,"btn","btn-danger",3,"click"],["href","javascript:window.history.back();",1,"btn","btn-info"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"h4"),d(2),c(),g(3,"br"),p(4,"h5"),d(5,"Are you sure about this?"),c(),p(6,"div",1)(7,"div",2),g(8,"img",3),c(),p(9,"div",4)(10,"dl")(11,"dt"),d(12," Supplier "),c(),p(13,"dd"),d(14),c(),p(15,"dt"),d(16," Name "),c(),p(17,"dd"),d(18),c(),p(19,"dt"),d(20," Description "),c(),p(21,"dd"),d(22),c(),p(23,"dt"),d(24," Value "),c(),p(25,"dd"),d(26),ae(27,"currencyBrazil"),c(),p(28,"dt"),d(29," Registration date "),c(),p(30,"dd"),d(31),ae(32,"date"),c(),p(33,"dt"),d(34," Active? "),c(),p(35,"dd"),g(36,"input",5),c()(),p(37,"div")(38,"a",6),z("click",function(){return i.eraseProduct()}),d(39,"Delete"),c(),d(40,"\xA0 "),p(41,"a",7),d(42,"Back"),c()()()()()),t&2&&(m(2),k("Delete ",i.product.name," "),m(6),Xe("src","",i.imagens,"",i.product.image,"",U),m(6),k(" ",i.product.supplierName," "),m(4),k(" ",i.product.name," "),m(4),k(" ",i.product.description," "),m(4),k(" ",oe(27,10,i.product.value,2)," "),m(5),k(" ",oe(32,13,i.product.registrationDate,"dd/MM/yyyy")," "),m(5),h("checked",i.product.active))},dependencies:[Ke,Ee]});let r=n;return r})();var ve=(()=>{let n=class n extends ti{constructor(e){super(e)}canDeactivate(e){return e.changesNotSaved?window.confirm("Changes aren't saved, Do you really want to leave?"):!0}canActivate(e){return super.validClaims(e)}};n.\u0275fac=function(t){return new(t||n)(_e(ce))},n.\u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();var ke=(()=>{let n=class n{constructor(e){this.productService=e}resolve(e){return this.productService.getById(e.params.id)}};n.\u0275fac=function(t){return new(t||n)(_e(q))},n.\u0275prov=Z({token:n,factory:n.\u0275fac});let r=n;return r})();var Ci=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=D({type:n,selectors:[["app-product-app"]],decls:1,vars:0,template:function(t,i){t&1&&g(0,"router-outlet")},dependencies:[Qt],encapsulation:2});let r=n;return r})();var Rr=[{path:"",component:Ci,children:[{path:"",redirectTo:"/product/list",pathMatch:"full"},{path:"list",component:fi},{path:"register",component:gi,canActivate:[ve],canDeactivate:[ve],data:[{claim:{name:"Produto",value:"Adicionar"}}]},{path:"edit/:id",component:vi,resolve:{product:ke},canActivate:[ve],data:[{claim:{name:"Produto",value:"Atualizar"}}]},{path:"details/:id",component:xi,resolve:{product:ke}},{path:"delete/:id",component:yi,resolve:{product:ke},canActivate:[ve],data:[{claim:{name:"Produto",value:"Excluir"}}]}]}],_i=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Me({type:n}),n.\u0275inj=Ce({imports:[He.forChild(Rr),He]});let r=n;return r})();var Ea={},Ra=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Me({type:n}),n.\u0275inj=Ce({providers:[q,ii(),ke,ve],imports:[_i,Ut,He,Xt,Gt,ri,Zt,ei,li,ut]});let r=n;return r})();export{Ra as ProductModule,Ea as maskConfig};
